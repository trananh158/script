--- setfpa
local RunService = game:GetService("RunService")

local TARGET_FRAME_RATE = 10

local frameStart = os.clock()

RunService.PreSimulation:Connect(function()
    while os.clock() - frameStart < 1 / TARGET_FRAME_RATE do
        -- We do nothing until the target time has elapsed
    end

    -- Mark the start of the next frame right before this one is rendered
    frameStart = os.clock()
end)


repeat task.wait(5) until game:IsLoaded()
local data_webhook ={
["3910084038"]="https://discord.com/api/webhooks/1183711913478213683/iAGMU2pMDeMMqkcQOVuJvVBWRYEtH0-BDIJeuZzvXlWQUKnIrpyAUoRg972YOR6SyCpR",
["2287660439"]="https://discord.com/api/webhooks/1183711890778628136/KJVaAXFh75QoIggKlzU8fnHb2fi3ekXJ8S-Lfv7B8B3S4vjqvHJxJ9z4wDu-7RVOxep0",
["5200405048"]="https://discord.com/api/webhooks/1183711861078769706/4UyWj6bhi3ZKGsDjRKEHCXflLs345K_mDcV8oN58OJ2GZeY7JENXc8qDXkMqqqy-rO8V",
["4467337735"]="https://discord.com/api/webhooks/1183418564284260422/1J_CTGxCrKd3qhEKGQlSKJ3XRtE3zGLboqo7IzSwzkb-xSFbUKLqwbEB03XX4SWX-LtX",
["3372701414"]="https://discord.com/api/webhooks/1183243637237223454/sZWTPdw9dqTQZHQMB_r1IGPtj2OxQBcePFDQOBbS-lMb1BQM5vbZatkAGT7A0ffAFpMB",
["1736283822"] = "https://discord.com/api/webhooks/1155081065547960432/GV3YlakPNr0joV_F_9X5-3YZs7NwLntS57XXBKYG3Oj19KK2Wwajqnqq0vxWmjI7quJs",
	["4658132822"] = "https://discord.com/api/webhooks/1183029994616791161/c2evR4wuUd8SaAhMxbex9GsDk7utgJiOAILlw9zSZQMeU_EMfPxsUbiLgL7wXTSm9LqB",
	["4316101960"]="https://discord.com/api/webhooks/1182581118172680282/kBYVXO-nYZQTJtTqjvEz6SGnxgzeBz46Zn0tx90LcQlSFDHJLCqwOWiUyl_MkJNcaC7u",
	["3879018373"] = "https://discord.com/api/webhooks/1147076687226486855/yhfnRyx4AXEOlqH74BhO8VYWnsO1nCO5h1o3PvhMZjqdH1GtyyxT-yd6tHSQixqUG70Z",
	["4850387536"] = "https://discord.com/api/webhooks/1182531760425287771/1k71hbo_dEpGwqlc6YgMaOqnQYnOwt5fI93H9rGMLMHpnVc63CGmjlJj4TSoAddbYgaT",
	["5138620245"]="https://discord.com/api/webhooks/1182152773467385978/TvaXe-w5QlpPItEk0oX5SXQJBhf8nxk__4FO3uv24wRstceI1CzMzRSLCma0lE7KlK_5",
	["1341421706"]="https://discord.com/api/webhooks/1181947627915456543/hQ4RfxQEBxRg6ILzOX2hufkJon7tv0G1MfGxSgiXHsbmjift0IIjZ65MMWx0s6WYFKF7",
	["4961859806"] = "https://discord.com/api/webhooks/1172014796686774403/Zk_Z6Z6lfexzZYX_1gGc_F5D68f4FHAVGWnQEbNqin238o0bb8mobRxxNIO1NDYV7LE4",
	["4651686048"] = "https://discord.com/api/webhooks/1172012098453250098/aUySW_ZZlxs672grCY_zS1-EM13xtUQs1A-CJgGo0zpCC_khodOf41OyVASDNY-hL2XX",
	["2211422144"] = "https://discord.com/api/webhooks/1159888760620724294/W6Qlg4khdXfjSQVYuitakm6f_DgVAJucgsgX8mrKbb2KtNywBHiCPhygLDvWH2FgdvU3",
	["1084652802"] = "https://discord.com/api/webhooks/1165887570945781821/UV0ix3mEAtkM5LqtiiBVgDa_KZ4Eo_rq2gfoQD_gEjJmuTQ_hBEJdJMW1b2qKK8YheXq",
	["1426708692"] = "https://discord.com/api/webhooks/1147076687226486855/yhfnRyx4AXEOlqH74BhO8VYWnsO1nCO5h1o3PvhMZjqdH1GtyyxT-yd6tHSQixqUG70Z",
	["1422506306"] = "https://discord.com/api/webhooks/1153950150960623617/1dAF8MuHBNJD6ZNFPfUojXLo5rV8uqQb7e0Z6wT4BM-OyU9bFKZm0snmHc_8xc4r48jx",
	["4056046798"] = "https://discord.com/api/webhooks/1162025851471286384/adVIo8lXdqPZJ28tsHeFm8F2fhDSf332SxoyVZfMcsamwONZjtOT9o3Iy4OLFrPtjo2y",
	["4540229340"] = "https://discord.com/api/webhooks/1163024453614190643/f0lLDq8Ob0tsrKb0sEWvmujsFyUTFmpPeOv0AAtCE5u9o0eeLAw0aiiuPCCOTH90XLvo",
	["3910107478"] = "https://discord.com/api/webhooks/1163024694019096628/Zy1tLE1-iwfscqdzCQJ2b3XRQkbmuZnAS6VRn-63lB8qY2dk787OcVv2gy5lyapsPUu7",
	["3986042340"] = "https://discord.com/api/webhooks/1153950496554500146/2t1HzB8vEz7YXQYD1WHu0o32HI4RaJTAMcR3USGfX6amaSQjQNiqm5Nq8rKpdRyI6Prv",
	["2395762597"] = "https://discord.com/api/webhooks/1152466075640922195/dRTayRxJK2Whf4TlrD8nz9NZ91r9UkprA6Zpvc9RCxKf2QME_LMbQd2XOal7GXLTc8p9",
        ["2455594430"] = "https://discord.com/api/webhooks/1169594749590700093/2l7ksxUmw-HNYhWJPjKBUBQQe7wrXvTOas8sZGIoTohXgnI7JhePhhe7rXVn0gDfYlcI",
	["422896529"] = "https://discord.com/api/webhooks/1163279693882073198/tbZd27jgMFv2cTlJsmv1gtoh-7bIy2sc-L3YWbhvpP8ECBf-F8MAJxAS7PI6pA-l1HLs",
	["1185544344"] = "https://discord.com/api/webhooks/1154267964623835186/RCIkOcyeFtLsoB-_CCsi9sGf_eW9nEYSBfJ6PM3apivG_W9egTDPxuPC1pjU3nuaJSHP",
	["3761394528"] = "https://discord.com/api/webhooks/1164459977147174952/VkFVLuD_yErgrlwZa4ick7y5Z2l3WEeaKIIG3lmnDw-ysb8kxuxF_MAaqMvjU1tN9pFB",
	["474851701"] = "https://discord.com/api/webhooks/1155690902556246036/-Z8iOIirPksMA3udnFkPc0tiyk3pAtLOfSX5HwVKOCZh11UEf3ixZwBHiRlDt2tGWK2t",
        ["1736283822"] = "https://discord.com/api/webhooks/1155081065547960432/GV3YlakPNr0joV_F_9X5-3YZs7NwLntS57XXBKYG3Oj19KK2Wwajqnqq0vxWmjI7quJs",
        ["980257840"] = "https://discord.com/api/webhooks/1176516852395036713/-KZiJBblHhCwbH_tTHBN0PRP2sAr9rG0Sl-pq509j-iVlQfR5SVUfnhvZIhXd1XF4r2B",
        ["2972754321"] = "https://discord.com/api/webhooks/1176517162962276394/xNVYt3bsR3J695b3OFzJs5xP18Ktt3i1QLJ0_6f1XIs6Jtsmm0QFcZ14e5PbGlGOBH0I",
        ["2946681130"] = "https://discord.com/api/webhooks/1177257397996232807/LRbetEtgYik7SNBQknUWLhLm6gREmf0dSfQnstpdJAQ7UngwjHFyFlW4HESm4Qif052W",
	["4804874853"] = "https://discord.com/api/webhooks/1164459977147174952/VkFVLuD_yErgrlwZa4ick7y5Z2l3WEeaKIIG3lmnDw-ysb8kxuxF_MAaqMvjU1tN9pFB",
	["3222406645"] = "https://discord.com/api/webhooks/1164250360634933340/soB6-FsA4_fP5oXzScAl9KteprVk61Q8KFZ80f3k1YZy7Uw062LYGSJK7MqOO4tyAyaV",
	["718583337"] = "https://discord.com/api/webhooks/1178251334546378752/0QCXkimp8NkcWpUsmFNq2lmhncmZUl52vt3wuCCS5f5YCAkQhtEXEQOMjBdS4m_6a5rA",
	["1717039300"] = "https://discord.com/api/webhooks/1163437749274157097/FTB7PZ-uni8GGN1N6VEKYwzXja8W4zWdjlpJmq28kMqIh2rW8K94vDM3WmGBzb8bnpfM",
	["4905276353"]="https://discord.com/api/webhooks/1180516792574160946/Fgb4kERqLxl0aEUDQ8_vpDZYPxEeVkQ6Nb7_ygxLI1Bbgjp3iZayLs15vEtKZdKtPmPJ",
	["5219250450"]="https://discord.com/api/webhooks/1181103895213244488/CMcELbgPbePnMFJvomghg7U60isegep7ji7_5CLnDBAiSiUtKE9t1pHuvtMDDj1CCZgL",
	["4531880933"] = "https://discord.com/api/webhooks/1181140233996222524/T6ymtcOIv90SQgqlbSkLQ2dlgCWrOcJl-37CiXa6HcKLEKjbr7p71cHpDzv_W6RhKl3v",
        ["2612789044"] = "https://discord.com/api/webhooks/1146638821165903882/2-0mn4cMcp0h_cyathxrheTbnDkk_o9WyCNhDc6K3FuYUgwYpsmPFDIRXw0KkbngoqCC",
}
print("GOooooooooooooooo")
local HttpService = game:GetService("HttpService")
local Workspace = game:GetService("Workspace") 
local plr = game:GetService("Players").LocalPlayer
local RunService = game:GetService("RunService")
local mouse = game.Players.LocalPlayer:GetMouse()
local UserInputService = game:GetService("UserInputService")


local v5 = require(game.ReplicatedStorage.src.Loader)
local ItemInventoryServiceClient = v5.load_client_service(script, "ItemInventoryServiceClient")
function get_inventory_items_unique_items()
	return ItemInventoryServiceClient["session"]['inventory']['inventory_profile_data']['unique_items']
end
-- Hien , trong value
function comma_value(p1)
	local value = p1;
	while true do
		local value2, value3 = string.gsub(value, "^(-?%d+)(%d%d%d)", "%1,%2");
		value = value2;
		if value3 ~= 0 then else
			break;
		end;
	end;
	return value;
end;
--- check keo
local CandiesOld = 0
if game.Players.LocalPlayer._stats:FindFirstChild("_resourceCandies") then
    CandiesOld = game.Players.LocalPlayer._stats._resourceCandies.Value
end
--------------------------------------------
------------item drop result----------------
local v5 = require(game.ReplicatedStorage.src.Loader)
local ItemInventoryServiceClient = v5.load_client_service(script, "ItemInventoryServiceClient")
function get_inventory_items_unique_items()
	return ItemInventoryServiceClient["session"]['inventory']['inventory_profile_data']['unique_items']
end
function get_inventory_items()
	return ItemInventoryServiceClient["session"]["inventory"]['inventory_profile_data']['normal_items']
end
function get_Units_Owner()
	return ItemInventoryServiceClient["session"]["collection"]["collection_profile_data"]['owned_units']
end
local Count_Portal_list = 0
local Table_All_Items_Old_data = {}
local Table_All_Items_New_data = {}
for v2, v3 in pairs(game:GetService("ReplicatedStorage").src.Data.Items:GetDescendants()) do
	if v3:IsA("ModuleScript") then
		for v4, v5 in pairs(require(v3)) do
		    Table_All_Items_Old_data[v4] = {}
			Table_All_Items_Old_data[v4]['Name'] = v5['name']
		    Table_All_Items_Old_data[v4]['Count'] = 0
			Table_All_Items_New_data[v4] = {}
			Table_All_Items_New_data[v4]['Name'] = v5['name']
			Table_All_Items_New_data[v4]['Count'] = 0
		end
	end
end
local Data_Units_All_Games = require(game:GetService("ReplicatedStorage").src.Data.Units)
for i,v in pairs(Data_Units_All_Games) do
    if v.rarity then
        Table_All_Items_Old_data[i] = {}
        Table_All_Items_Old_data[i]['Name'] = v['name']
        Table_All_Items_Old_data[i]['Count'] = 0
        Table_All_Items_Old_data[i]['Count Shiny'] = 0
        Table_All_Items_New_data[i] = {}
        Table_All_Items_New_data[i]['Name'] = v['name']
        Table_All_Items_New_data[i]['Count'] = 0
        Table_All_Items_New_data[i]['Count Shiny'] = 0
    end
end
for i,v in pairs(get_inventory_items()) do
	Table_All_Items_Old_data[i]['Count'] = v
end
for i,v in pairs(get_inventory_items_unique_items()) do
    if string.find(v['item_id'],"portal") or string.find(v['item_id'],"disc") then
        Count_Portal_list = Count_Portal_list + 1
        Table_All_Items_Old_data[v['item_id']]['Count'] = Table_All_Items_Old_data[v['item_id']]['Count'] + 1
    end
end
for i,v in pairs(get_Units_Owner()) do
    Table_All_Items_Old_data[v["unit_id"]]['Count'] = Table_All_Items_Old_data[v["unit_id"]]['Count'] + 1
    if v.shiny then
        Table_All_Items_Old_data[v["unit_id"]]['Count'] = Table_All_Items_Old_data[v["unit_id"]]['Count'] - 1
        Table_All_Items_Old_data[v["unit_id"]]['Count Shiny'] = Table_All_Items_Old_data[v["unit_id"]]['Count Shiny'] + 1
    end
end


---------------------webhook----------------------------------
function webhook()
	url_webhook = "https://discord.com/api/webhooks/1155312152459104286/w9KlXRsVxqA4QyTsnzDz9eQRrut38tInLPRHCpqVVzeCXIj_HmzcN5i1YIknENxcVjwG"
		
	if data_webhook[tostring(game:GetService("Players").LocalPlayer.UserId)] ~= nil then
		warn(tostring(game:GetService("Players").LocalPlayer.UserId))
		warn(data_webhook[tostring(game:GetService("Players").LocalPlayer.UserId)])
		url_webhook = tostring(data_webhook[tostring(game:GetService("Players").LocalPlayer.UserId)])
		warn(url_webhook)
	elseif ma_webhook ~= nil then
		url_webhook = ma_webhook
	end
	
	--- Linh tinh
	local Time = os.date('!*t', OSTime);
	plr = game:GetService("Players").LocalPlayer
	local thumbnails_avatar = HttpService:JSONDecode(game:HttpGet("https://thumbnails.roblox.com/v1/users/avatar-headshot?userIds=" .. game:GetService("Players").LocalPlayer.UserId .. "&size=150x150&format=Png&isCircular=true", true))
	--------- Kiểm tra có thắng hay không
	local result = "1"
	if game:GetService("Players").LocalPlayer.PlayerGui:FindFirstChild("ResultsUI"):FindFirstChild("Holder").Title.Text == "VICTORY" then result = "VICTORY"
	else result = "DEFEAT" end
	print(result)
	--- Xem cổng còn lại trong túi đồ
	for i,v in pairs(get_inventory_items_unique_items()) do
            if string.find(v['item_id'],"portal") then
                --if v['item_id'] == Settings.SelectedSellPortals then
                --if v["_unique_item_data"]["_unique_portal_data"]["portal_depth"] == Settings.SelectedSellTier then

                    --PortalsDiff = v["_unique_item_data"]["_unique_portal_data"]["difficulty_scale"]

                --end
            end
        end
--- Xem thông tin map
	local plr = game:GetService("Players").LocalPlayer
	ResultHolder = plr.PlayerGui:FindFirstChild("ResultsUI"):FindFirstChild("Holder")
	--- Map và độ khó

	GetLevelData = game.workspace._MAP_CONFIG:WaitForChild("GetLevelData"):InvokeServer()
	name = GetLevelData.id or GetLevelData.world or GetLevelData.map
	world = GetLevelData.name
	--New Mapname
	local Loader = require(game.ReplicatedStorage.src.Loader)
	local Maps = Loader.load_data(script, "Maps")
	local v100 = Maps[Loader.LevelData.map]
	MapsNameTEST = v100.name or GetLevelData.name
	--Difficulty
	MapDiff2 = game:GetService("Players").LocalPlayer.PlayerGui.ResultsUI.Holder.Difficulty.Text
	MapDiff3 = MapDiff2
	if GetLevelData.name == "Summer Hunt" then MapDiff3 = " [ Default ] Is a Portal " end
	
	-- portal tier Changed
	local v5 = require(game.ReplicatedStorage.src.Loader)
	local poratltierS = v5.LevelData._portal_depth
	if poratltierS == nil then poratltierS = " Not a Portal " end

	local v5 = require(game.ReplicatedStorage.src.Loader)
	local poratChallengeS = v5.LevelData._challenge
	if poratChallengeS == nil then poratChallengeS = " Not a Portal " end
	if poratChallengeS == "double_cost" then poratChallengeS = "High Cost" end
	if poratChallengeS == "short_range" then poratChallengeS = "Short Range" end
	if poratChallengeS == "fast_enemies" then poratChallengeS = "Fast Enemies" end
	if poratChallengeS == "regen_enemies" then poratChallengeS = "Regen Enemies" end
	if poratChallengeS == "tank_enemies" then poratChallengeS = "Tank Enemies" end
	if poratChallengeS == "shield_enemies" then poratChallengeS = "Shield Enemies" end
	if poratChallengeS == "triple_cost" then poratChallengeS = "Triple Cost" end
	if poratChallengeS == "hyper_regen_enemies" then poratChallengeS = "Hyper-Regen Enemies" end
	if poratChallengeS == "hyper_shield_enemies" then poratChallengeS = "Steel-Plated Enemies" end
	if poratChallengeS == "godspeed_enemies" then poratChallengeS = "Godspeed Enemies" end
	if poratChallengeS == "flying_enemies" then poratChallengeS = "Flying Enemies" end
	if poratChallengeS == "mini_range" then poratChallengeS = "Mini-Range" end
	
	--- Thời gian & số wave (ttime[2]  waves[2])

	cwaves = game:GetService("Players").LocalPlayer.PlayerGui.ResultsUI.Holder.Middle.WavesCompleted.Text
	ctime = game:GetService("Players").LocalPlayer.PlayerGui.ResultsUI.Holder.Middle.Timer.Text
	waves = cwaves:split(": ")
	if waves ~= nil and waves[2] == "999" then waves[2] = "Use [Auto Leave at Wave] or [Test Webhook]" end	
	ttime = ctime:split(": ")
	if waves ~= nil and ttime[2] == "22:55" then ttime[2] = "Use [Auto Leave at Wave] or [Test Webhook]" end
	totaltime =  ResultHolder:FindFirstChild("Middle"):FindFirstChild("Timer").Text
	totalwaves = ResultHolder:FindFirstChild("Middle"):FindFirstChild("WavesCompleted").Text
	print(ttime)
	print(waves)

	--- Gem re + gold re + xp
	const_drop = ""
	gold = ResultHolder:FindFirstChild("LevelRewards"):FindFirstChild("ScrollingFrame"):FindFirstChild("GoldReward"):FindFirstChild("Main"):FindFirstChild("Amount").Text
	if gold ~= "+99999" then const_drop = const_drop..gold.." Gold\n" end	    
	gems = ResultHolder:FindFirstChild("LevelRewards"):FindFirstChild("ScrollingFrame"):FindFirstChild("GemReward"):FindFirstChild("Main"):FindFirstChild("Amount").Text
	if gems ~= "+99999" then const_drop = const_drop..gems.." Gems\n" end	 

	xpx = ResultHolder:FindFirstChild("LevelRewards"):FindFirstChild("ScrollingFrame"):FindFirstChild("XPReward"):FindFirstChild("Main"):FindFirstChild("Amount").Text
	xp = xpx:split(" ")
	if xp[1] ~= "+99999" then const_drop = const_drop..xp[1].." Xp\n" end

	--- Item drop
	local TextDropLabel = ""
	local CountAmount = 1
	for i,v in pairs(get_inventory_items()) do
		Table_All_Items_New_data[i]['Count'] = v
	end
	for i,v in pairs(get_inventory_items_unique_items()) do
		if string.find(v['item_id'],"portal") or string.find(v['item_id'],"disc") then
			Table_All_Items_New_data[v['item_id']]['Count'] = Table_All_Items_New_data[v['item_id']]['Count'] + 1
		end
	end
	for i,v in pairs(get_Units_Owner()) do
		Table_All_Items_New_data[v["unit_id"]]['Count'] = Table_All_Items_New_data[v["unit_id"]]['Count'] + 1
		if v.shiny then
			Table_All_Items_New_data[v["unit_id"]]['Count'] = Table_All_Items_New_data[v["unit_id"]]['Count'] - 1
		Table_All_Items_New_data[v["unit_id"]]['Count Shiny'] = Table_All_Items_New_data[v["unit_id"]]['Count Shiny'] + 1
		end
	end
	for i,v in pairs(Table_All_Items_New_data) do
		if v['Count'] > 0 and (v['Count'] - Table_All_Items_Old_data[i]['Count']) > 0 then
			if v['Count Shiny'] and v['Count'] then
				if v['Count'] > 0 or v['Count Shiny'] > 0 then
					if v['Count'] > 0 and (v['Count'] - Table_All_Items_Old_data[i]['Count']) > 0 then
						TextDropLabel = TextDropLabel .. tostring(CountAmount) .. ". " .. tostring(v['Name']) .. " : x" .. tostring(v['Count'] - Table_All_Items_Old_data[i]['Count'])
						if v['Count Shiny'] > 0 and (v['Count Shiny'] - Table_All_Items_Old_data[i]['Count Shiny']) > 0 then
							TextDropLabel = TextDropLabel .. " | " .. tostring(v['Name']) .. " (Shiny) : x" .. tostring(v['Count Shiny'] - Table_All_Items_Old_data[i]['Count Shiny']) .. "\n"
							CountAmount = CountAmount + 1
						else
							TextDropLabel = TextDropLabel .. "\n"
							CountAmount = CountAmount + 1
						end
					end
				end
			end
		elseif v['Count Shiny'] and v['Count Shiny'] > 0 and (v['Count Shiny'] - Table_All_Items_Old_data[i]['Count Shiny']) > 0 then
			TextDropLabel = TextDropLabel .. tostring(CountAmount) .. ". " .. tostring(v['Name']) .. " (Shiny) : x" .. tostring(v['Count Shiny'] - Table_All_Items_Old_data[i]['Count Shiny']) .. "\n"
			CountAmount = CountAmount + 1
		end
	end
	for i,v in pairs(Table_All_Items_New_data) do
		if v['Count'] > 0 and (v['Count'] - Table_All_Items_Old_data[i]['Count']) > 0 then
		--if v['Count'] > 0 and (v['Count'] == Table_All_Items_Old_data[i]['Count']) > 0 then
			if v['Count Shiny'] and v['Count'] then
			elseif string.find(i,"portal") or string.find(i,"disc") then
				Count_Portal_list = Count_Portal_list + 1
			if string.gsub(i, "%D", "") == "" then
					TextDropLabel = TextDropLabel .. tostring(CountAmount) .. ". " .. tostring(v['Name']) .. " :x" .. tostring(v['Count'] - Table_All_Items_Old_data[i]['Count']) .. " (Số lượng: " .. v['Count'] ..")\n"
			else
					TextDropLabel = TextDropLabel .. tostring(CountAmount) .. ". " .. tostring(v['Name']) .. " Tier " .. tostring(string.gsub(i, "%D", "")) .. " : x" .. tostring(v['Count'] - Table_All_Items_Old_data[i]['Count']) .. "\n"
				end
				CountAmount = CountAmount + 1
			else
				TextDropLabel = TextDropLabel .. tostring(CountAmount) .. ". " .. tostring(v['Name']) .. " : x" .. tostring(v['Count'] - Table_All_Items_Old_data[i]['Count']) .. " (số lượng : "..v['Count']..")\n"
				CountAmount = CountAmount + 1
			end
		end
	end
	--end

	if TextDropLabel == "" then
		TextDropLabel = "không có đồ rơi"
	end
	text_tag = ""
	item_secret = {"Zid","Detective Shard","Path Portal","Golden Portal","Byu"}
	for k,v23 in pairs(item_secret) do
	  if string.find(TextDropLabel,v23) ~= nil then
		text_tag = "@everyone, bạn đã nhận được "..v23
	  end
	end

	candis_re = game.Players.LocalPlayer._stats._resourceCandies.Value - CandiesOld
	if candis_re > 0 then const_drop = const_drop.."+"..candis_re.." Candy\n" end 
	local data={
		  ["content"] = text_tag,
		  ["embeds"] = {
			{
			  ["title"] = "Loan Kitru hub",
			  ["color"] = 9424774,
			  ["fields"] = {
				{
				  ["name"] = "Thông tin",
				  ["value"] = "Tên : ||"..game:GetService("Players").LocalPlayer.Name.."||\nLevel: "..tostring(game.Players.LocalPlayer.PlayerGui.spawn_units.Lives.Main.Desc.Level.Text).."\nPortal còn: "..tostring(Count_Portal_list).." 🌀"
				},
				{
				  ["name"] = "Thống kê",
				  ["value"] = "**💎 "..tostring(comma_value(game.Players.LocalPlayer._stats.gem_amount.Value)).."\n💰 "..tostring(comma_value(game.Players.LocalPlayer._stats.gold_amount.Value)).."$\n🍬 "..tostring(comma_value(game.Players.LocalPlayer._stats._resourceCandies.Value)).."**",
				  ["inline"] = true
				},
				{
				  ["name"] = "Phần thưởng",
				  ["value"] = const_drop..TextDropLabel,
				  ["inline"] = true
				},
				{
				  ["name"] = "Kết quả",
				  ["value"] = result.."\n"..tostring(MapsNameTEST).."\n"..tostring(poratltierS).."-"..tostring(poratChallengeS).."\nWave:"..tostring(waves[2]).."("..tostring(ttime[2])..")"
				}
			  },
			  ["footer"] = {
				["text"] = "Discord Loan Kitru",
				["icon_url"] = "https://cdn.discordapp.com/avatars/581434795813371913/0cccae82397f24c0323d7046333d9f8e.webp?size=128"
			  },
			  ["timestamp"] = string.format('%d-%d-%dT%02d:%02d:%02dZ', Time.year, Time.month, Time.day, Time.hour, Time.min, Time.sec)
			}
		  }
	}

        local porn = game:GetService("HttpService"):JSONEncode(data)
        local headers = {["content-type"] = "application/json"}
        local request = http_request or request or HttpPost or syn.request or http.request
        local sex = {Url = url_webhook, Body = porn, Method = "POST", Headers = headers}
        warn("Sending webhook notification...")
		print("ruuunnnnnnn")
        request(sex)
end
--wait(10)
--webhook()
_G.check_webhook = true
coroutine.resume(coroutine.create(function()
    task.spawn(function()
        local GameFinished = game:GetService("Workspace"):WaitForChild("_DATA"):WaitForChild("GameFinished")
        GameFinished:GetPropertyChangedSignal("Value"):Connect(function()
            print("Changed", GameFinished.Value == true)
            if GameFinished.Value == true and _G.check_webhook == true then
		_G.check_webhook = false
                repeat task.wait() until  game:GetService("Players").LocalPlayer.PlayerGui.ResultsUI.Enabled == true
                pcall(function() webhook() end)
                warn("Wait next or leave")
			end
		end)
	end)
end))


-- ATUO RECONTECTION WEN DISCONNETC
game:GetService("GuiService").ErrorMessageChanged:Connect(function()
wait (5) game:GetService("TeleportService"):Teleport(8304191830)
    end);

--- setfpa
local RunService = game:GetService("RunService")

local TARGET_FRAME_RATE = 10

local frameStart = os.clock()

RunService.PreSimulation:Connect(function()
    while os.clock() - frameStart < 1 / TARGET_FRAME_RATE do
        -- We do nothing until the target time has elapsed
    end

    -- Mark the start of the next frame right before this one is rendered
    frameStart = os.clock()
end)

